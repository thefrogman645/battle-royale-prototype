<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Notjin Ops: Web Battle Royale</title>
<style>
html, body { margin:0; padding:0; overflow:hidden; background:#000; }
#ui { position: fixed; top:10px; left:10px; color:#0f0; font-family: monospace; z-index:10; background: rgba(0,0,0,0.5); padding:8px; border-radius:8px; }
#crosshair { position: fixed; top:50%; left:50%; width:6px; height:6px; margin-left:-3px; margin-top:-3px; background:#0f0; border-radius:50%; z-index:9; }
#start { position: fixed; inset:0; display:flex; align-items:center; justify-content:center; background: radial-gradient(circle at center, #111, #000); color:#0f0; font-family: monospace; z-index:20; }
button { font-size:18px; padding:12px 18px; cursor:pointer; margin:5px; }
</style>
</head>
<body>
<div id="start">
<div>
<button id="playBtn">Start Game</button><br>
<button id="modeBR">Battle Royale</button>
<button id="modeTD">Team Deathmatch</button>
</div>
</div>
<div id="ui">HP: <span id="hp">100</span> | Loot: <span id="loot">0</span> | Enemies: <span id="enemies">0</span></div>
<div id="crosshair"></div>
<script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
<script>
let scene,camera,renderer;
let keys={},bullets=[],enemies=[],loot=[];
let hp=100,lootCount=0; 
let gameMode='BR';
const speed=0.12,gravity=0.15,playerYVelocity=0;
let velocityY=0;
init();
animate();

function init(){
scene=new THREE.Scene();
scene.fog=new THREE.Fog(0x000000,0,60);
camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,0.1,1000);
camera.position.y=1.6;
renderer=new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth,window.innerHeight);
document.body.appendChild(renderer.domElement);
const light=new THREE.HemisphereLight(0xffffff,0x222222,1);
scene.add(light);
const floor=new THREE.Mesh(new THREE.PlaneGeometry(200,200),new THREE.MeshStandardMaterial({color:0x222222}));
floor.rotation.x=-Math.PI/2;
scene.add(floor);
for(let i=0;i<20;i++){
const wall=new THREE.Mesh(new THREE.BoxGeometry(2,3,2),new THREE.MeshStandardMaterial({color:0x444444}));
wall.position.set((Math.random()-0.5)*80,1.5,(Math.random()-0.5)*80);
scene.add(wall);
}
for(let i=0;i<10;i++)spawnEnemy();
for(let i=0;i<15;i++)spawnLoot();
updateUI();
document.addEventListener('keydown',e=>keys[e.code]=true);
document.addEventListener('keyup',e=>keys[e.code]=false);
document.addEventListener('click',shoot);
document.getElementById('playBtn').onclick=()=>{document.body.requestPointerLock(); document.getElementById('start').style.display='none';};
document.getElementById('modeBR').onclick=()=>gameMode='BR';
document.getElementById('modeTD').onclick=()=>gameMode='TD';
document.addEventListener('mousemove',e=>{
if(document.pointerLockElement===document.body){
camera.rotation.y-=e.movementX*0.002;
camera.rotation.x-=e.movementY*0.002;
camera.rotation.x=Math.max(-Math.PI/2,Math.min(Math.PI/2,camera.rotation.x));
}
});
window.addEventListener('resize',()=>{camera.aspect=window.innerWidth/window.innerHeight;camera.updateProjectionMatrix();renderer.setSize(window.innerWidth,window.innerHeight);});
}

function shoot(){if(document.pointerLockElement!==document.body)return;
const bullet=new THREE.Mesh(new THREE.SphereGeometry(0.05,8,8),new THREE.MeshBasicMaterial({color:0x00ff00}));
bullet.position.copy(camera.position);
bullet.direction=new THREE.Vector3(0,0,-1).applyQuaternion(camera.quaternion);
scene.add(bullet);
bullets.push(bullet);}

function spawnEnemy(){
const enemy=new THREE.Mesh(new THREE.BoxGeometry(1,2,1),new THREE.MeshStandardMaterial({color:0xff0000}));
enemy.position.set((Math.random()-0.5)*60,1,(Math.random()-0.5)*60);
enemy.hp=3;
scene.add(enemy);
enemies.push(enemy);}

function spawnLoot(){
const chest=new THREE.Mesh(new THREE.BoxGeometry(1,1,1),new THREE.MeshStandardMaterial({color:0xffff00}));
chest.position.set((Math.random()-0.5)*60,0.5,(Math.random()-0.5)*60);
scene.add(chest);
loot.push(chest);}

function animate(){
requestAnimationFrame(animate);
// Grounded movement
let dir=new THREE.Vector3();
if(keys['KeyW'])dir.z-=1;
if(keys['KeyS'])dir.z+=1;
if(keys['KeyA'])dir.x-=1;
if(keys['KeyD'])dir.x+=1;
dir.normalize().applyQuaternion(camera.quaternion);
camera.position.addScaledVector(dir,speed);
// Gravity
velocityY-=gravity;
camera.position.y+=velocityY;
if(camera.position.y<1.6){camera.position.y=1.6; velocityY=0;}
if(keys['Space'] && camera.position.y<=1.61) velocityY=0.35;

// Bullets
bullets.forEach((b,i)=>{b.position.addScaledVector(b.direction,0.8);
enemies.forEach((e,ei)=>{if(b.position.distanceTo(e.position)<1){e.hp--; scene.remove(b); bullets.splice(i,1); if(e.hp<=0){scene.remove(e); enemies.splice(ei,1); spawnEnemy(); updateUI();}}});});

// Enemies
enemies.forEach(e=>{
const v=camera.position.clone().sub(e.position).normalize();
e.position.addScaledVector(v,0.03);
if(e.position.distanceTo(camera.position)<1.5){hp-=0.1;if(hp<=0) location.reload();updateUI();}
});

// Loot
loot.forEach((c,i)=>{if(c.position.distanceTo(camera.position)<1){lootCount++; scene.remove(c); loot.splice(i,1); updateUI();}});

renderer.render(scene,camera);}

function updateUI(){document.getElementById('hp').textContent=Math.max(0,Math.floor(hp)); document.getElementById('loot').textContent=lootCount; document.getElementById('enemies').textContent=enemies.length;}
</script>
</body>
</html>
